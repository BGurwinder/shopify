{{ 'header-navigation.css' | asset_url | stylesheet_tag }}

{% style %}
  .mobile-bottom-nav {
    background-color: {{ section.settings.background_color }};
    border-top: 1px solid {{ section.settings.border_color }};
  }

  .mobile-nav-item {
    color: {{ section.settings.text_color }};
    font-size: {{ section.settings.font_size }}px;
  }

  .mobile-nav-item.active {
    color: {{ section.settings.active_color }};
  }

  .mobile-nav-icon {
    width: {{ section.settings.icon_size }}px;
    height: {{ section.settings.icon_size }}px;
  }
  
  .mobile-nav-icon svg,
  .mobile-nav-icon img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
{% endstyle %}

<div class="mobile-bottom-nav">
  {% for block in section.blocks %}
    {%- case block.settings.action -%}
      {%- when 'menu' -%}
        <a href="#" class="mobile-nav-item" data-action="toggle-menu" title="{{ block.settings.heading }}" {{ block.shopify_attributes }}>
      {%- when 'search' -%}
        <a href="#" class="mobile-nav-item" data-action="toggle-search" title="{{ block.settings.heading }}" {{ block.shopify_attributes }}>
      {%- when 'cart' -%}
        <a href="{{ routes.cart_url }}" class="mobile-nav-item" id="mobile-cart-icon" title="{{ block.settings.heading }}" {{ block.shopify_attributes }}>
      {%- when 'account' -%}
        <a href="{{ routes.account_url }}" class="mobile-nav-item" title="{{ block.settings.heading }}" {{ block.shopify_attributes }}>
      {%- else -%}
        <a href="{{ block.settings.link }}" class="mobile-nav-item" title="{{ block.settings.heading }}" {{ block.shopify_attributes }}>
    {%- endcase -%}
    
      <div class="mobile-nav-icon">
        {% if block.settings.custom_icon != blank %}
          {{ block.settings.custom_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
        {% elsif block.settings.icon_svg != blank %}
          {{ block.settings.icon_svg }}
        {% else %}
          {% comment %} Fallback/Default Icons based on block type or action {% endcomment %}
          {% if block.settings.action == 'menu' %}
             <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
          {% elsif block.settings.action == 'search' %}
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" fill="none"><path d="M6 0C9.31371 0 12 2.68629 12 6C12 7.47681 11.4649 8.82772 10.5801 9.87305L15.3535 14.6465C15.5488 14.8417 15.5488 15.1583 15.3535 15.3535C15.1583 15.5488 14.8417 15.5488 14.6465 15.3535L9.87305 10.5801C8.82772 11.4649 7.47681 12 6 12C2.68629 12 0 9.31371 0 6C0 2.68629 2.68629 0 6 0ZM6 1C3.23858 1 1 3.23858 1 6C1 8.76142 3.23858 11 6 11C8.76142 11 11 8.76142 11 6C11 3.23858 8.76142 1 6 1Z" fill="currentColor"/></svg>
          {% elsif block.settings.action == 'cart' %}
             <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
          {% elsif block.settings.action == 'account' %}
             <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
          {% else %}
             <!-- Default Home Icon -->
             <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          {% endif %}
        {% endif %}
      </div>
      <span>{{ block.settings.heading }}</span>
      
      {% if block.settings.action == 'cart' and cart.item_count > 0 %}
        <span class="mobile-cart-count">{{ cart.item_count }}</span>
      {% endif %}
    </a>
  {% endfor %}
</div>

<script src="{{ 'mobile-bottom-nav.js' | asset_url }}" defer="defer"></script>

{% schema %}
{
  "name": "Mobile Bottom Nav",
  "settings": [
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#e5e5e5"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text & Icon Color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "active_color",
      "label": "Active Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Sizing"
    },
    {
      "type": "range",
      "id": "icon_size",
      "min": 20,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Icon Size",
      "default": 24
    },
    {
      "type": "range",
      "id": "font_size",
      "min": 8,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Font Size",
      "default": 10
    }
  ],
  "blocks": [
    {
      "type": "nav_item",
      "name": "Nav Item",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Label",
          "default": "Home"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "select",
          "id": "action",
          "label": "Special Action",
          "options": [
            { "value": "none", "label": "None (Use Link)" },
            { "value": "menu", "label": "Toggle Menu" },
            { "value": "search", "label": "Toggle Search" },
            { "value": "cart", "label": "Cart" },
            { "value": "account", "label": "Account" }
          ],
          "default": "none"
        },
        {
          "type": "header",
          "content": "Icon"
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom Icon Image"
        },
        {
          "type": "html",
          "id": "icon_svg",
          "label": "SVG Code",
          "info": "Paste SVG code here to override default."
        }
      ]
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "nav_item",
        "settings": {
          "heading": "Home",
          "link": "/",
          "action": "none"
        }
      },
      {
        "type": "nav_item",
        "settings": {
          "heading": "Menu",
          "action": "menu"
        }
      },
      {
        "type": "nav_item",
        "settings": {
          "heading": "Search",
          "action": "search"
        }
      },
      {
        "type": "nav_item",
        "settings": {
          "heading": "Cart",
          "action": "cart"
        }
      }
    ]
  }
}
{% endschema %}
